<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">>
<head>
    <meta charset="utf-8" />
    <meta name="viewport"    content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content=""/>
    <meta name="author"      content="Sergey Pozhilov (GetTemplate.com)"/>

    <title>Coconut drink</title>

    <link rel="shortcut icon" href="../static/images/favicon-16x16.png" th:href="@{/images/favicon-16x16.png}"/>

    <link rel="stylesheet" media="screen" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,700"/>
    <link rel="stylesheet" href="../static/css/bootstrap.min.css" th:href="@{/css/bootstrap.min.css}"/>
    <link rel="stylesheet" href="../static/css/font-awesome.min.css" th:href="@{/css/font-awesome.min.css}"/>

    <!-- Custom styles for our template -->
    <link rel="stylesheet" href="../static/css/bootstrap-theme.css" media="screen" th:href="@{/css/bootstrap-theme.css}"/>
    <link rel="stylesheet" href="../static/css/main.css" th:href="@{/css/main.css}"/>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="../static/js/html5shiv.js" th:src="@{/js/html5shiv.js}"></script>
    <script src="../static/js/respond.min.js" th:src="@{/js/respond.min.js}"></script>
    <![endif]-->
</head>

<body class="home">
    <!-- Fixed navbar -->
    <div class="navbar navbar-inverse navbar-fixed-top headroom" >
        <div class="container">
            <div class="navbar-header">
                <!-- Button for smallest screens -->
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"><span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button>
                <a class="navbar-brand" href="/"><!--<img src="../static/images/coconut-water.jpg" th:src="@{/images/coconut-water.jpg}" width="50px" alt="Drink the Purest"/>--></a>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav pull-right">
                    <li class="active"><a href="/">Home</a></li>
                    <li><a href="../static/pages/about.html" th:href="@{/pages/about.html}">About</a></li>
                    <li><a href="../static/pages/contact.html" th:href="@{/pages/Contact.html}">Contact</a></li>
                    <li sec:authorize="isAuthenticated()"><a class="btn" href="/loginPage" sec:authentication="name">user</a></li>
                    <li sec:authorize="isAuthenticated()"><a class="btn" href="javascript: document.logoutForm.submit()">Logout</a></li>
                    <li sec:authorize="isAnonymous()"><a class="btn" href="/loginPage">SIGN IN / SIGN UP</a></li>
                </ul>
                <form name="logoutForm" th:action="@{/logout}" method="post" th:hidden="true">
                    <input hidden type="submit" value="Sign Out"/>
                </form>
            </div><!--/.nav-collapse -->
        </div>
    </div>
    <header id="head" class="secondary"></header>
    <!-- container -->
    <div class="container">

        <h2 class="text-center top-space" th:inline="text">[[${subscriptionPlan.product.productName}]]-[[${subscriptionPlan.planName}]]</h2>
        <br>

        <div class="row">
            <div class="col-sm-6">
                <h3>Subscription Starts on</h3>
                <p style="color:#009688" th:text="${#dates.format(subscription.startDate, 'dd-MMM-yyyy')}"></p>
                <h3>Subscription Ends on</h3>
                <p style="color:#009688" th:text="${#dates.format(subscription.endDate, 'dd-MMM-yyyy')}"></p>
                <h3>Price per <span th:text="${subscriptionPlan.product.measurementUnit}" </h3>
                <p style="color:#009688" th:inline="text">â‚¹ [[${subscriptionPlan.product.pricePerUnit}]]</p>
            </div>
            <div class="col-sm-6">
                <form role="form" data-toggle="validator" id="productSubscribeForm" action="/product/subscribe/" method="post">
                    <input id="measurementUnit" hidden th:value="${subscriptionPlan.product.measurementUnit}" type="text">
                    <input id="pricePerUnit" hidden th:value="${subscriptionPlan.product.pricePerUnit}" type="text">
                    <input hidden id="actualPrice" name="actualPrice" type="text">
                    <input hidden id="totalPrice" name="totalPrice" type="text">
                    <input id="totalNumberOfDays" hidden name="totalNumberOfDays" th:value="${subscription.totalNumberOfDays}" type="text">
                    <div class="form-group top-margin">
                        <label>Quantity per day<span class="text-danger">*</span></label>
                        <input id="quantityPerDay" required name="quantityPerDay" data-error="Please fill this field" type="text" class="form-control">
                        <div class="help-block with-errors"></div>
                    </div>
                    <div>
                        <h4 hidden>Total quantity = <span style="color:#009688" id="displayTotQty"></span></h4>
                        <h4 hidden>Total price = <span style="color:#009688" id="displayTotPrice"></span></h4>
                    </div>
                    <div class="form-group top-margin">
                        <label>Preferred Delivery time</label>
                            <select  name="preferredDeliveryTime" data-error="Please choose this field" type="text" class="form-control">
                                <option value="7">07</option><option value="8">08</option>
                                <option value="9">09</option><option value="10" selected>10</option>
                                <option value="11">11</option><option value="12">12</option>
                                <option value="13">13</option><option value="14">14</option>
                                <option value="15">15</option><option value="16">16</option>
                                <option value="17">17</option><option value="18">18</option>
                            </select>
                        <div class="help-block with-errors"></div>
                    </div>
                    <option selected disabled hidden style='display: none' value=''></option>
                </form>
            </div>
        </div> <!-- /row -->
    </div>	<!-- /container -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
    <script src="../static/js/headroom.min.js" th:src="@{/js/headroom.min.js}"></script>
    <script src="../static/js/jQuery.headroom.min.js" th:src="@{/js/jQuery.headroom.min.js}"></script>
    <script src="../static/js/template.js" th:src="@{/js/template.js}"></script>
    <script type="text/javascript">
        $('#quantityPerDay').change(function () {
            var pricePerUnit=$('#pricePerUnit').val();
            var actualPrice;
            var totalQuantity;
            var totalNumberOfDays = $('#totalNumberOfDays').val();
            var quantityPerDay=$('#quantityPerDay').val();
            var isQuantityInvalid=false;
            console.log('quantityPerDay:'+quantityPerDay);
            var isQuantityInt =($.isNumeric(quantityPerDay) && quantityPerDay % 1 === 0);
            var isQuantityDouble =($.isNumeric(quantityPerDay) && quantityPerDay % 1 !== 0);
            var measurementUnit = $('#measurementUnit').val();
            console.log('measurementUnit:'+measurementUnit+',isQuantityInt:'+isQuantityInt+',isQuantityDouble:'+isQuantityDouble)
            if(!isQuantityInt && !isQuantityDouble){
                alert("Invalid quantity value");
                $('#quantityPerDay').val('');
                isQuantityInvalid=true;
            }
            if(measurementUnit =='piece' && !isQuantityInt){
                alert("Invalid quantity value for this product")
                $('#quantityPerDay').val('');
                isQuantityInvalid=true;
            }
            console.log('isQuantityInvalid:'+isQuantityInvalid);
            if(!isQuantityInvalid) {
                $('#displayTotPrice').parent().hide();
                $('#displayTotQty').parent().hide();
                actualPrice = pricePerUnit * totalNumberOfDays * quantityPerDay;
                totalQuantity = totalNumberOfDays * quantityPerDay;
                console.log('actualPrice:'+actualPrice);
                console.log('totalQuantity:'+totalQuantity);
                $('#actualPrice').val(actualPrice);
                $('#totalPrice').val(actualPrice);
                $('#displayTotPrice').html(actualPrice);
                $('#displayTotPrice').parent().show();
                $('#totalQuantity').val(totalQuantity);
                $('#displayTotQty').html(totalQuantity);
                $('#displayTotQty').parent().show();
            }
        });
    </script>
</body>
</html>